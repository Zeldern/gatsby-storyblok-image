function t(){return t=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(t[a]=i[a])}return t},t.apply(this,arguments)}const e=/^(https?:)?\/\/a.storyblok.com\/f\/*[0-9]+\/*[0-9]*x*[0-9]*\/[A-Za-z0-9]+\/[\S]+\.[a-zA-Z]+/;function i(t){let i=null,a=null;if("string"==typeof t&&(i=t),"object"==typeof t&&(i=t.image,a=t.base64?t.base64:null),i=e.test(i)?i:null,!i)return!1;let r=i.replace(/^(https?:)?\/\/a.storyblok.com\//,""),[,,l,,n]=r.split("/"),[o,s]=l.split("x").map(t=>parseInt(t,10)),[,h]=n.split(".");return{originalPath:r,extension:h,metadata:{dimensions:{width:o,height:s,aspectRatio:o/s},lqip:a}}}const a=[1,1.5,2,3],r=[.25,.5,1,1.5,2,3],l={quality:100,smartCrop:!0,format:null,fill:null,toFormat:null,base64:null,useBase64:!0},n=t({},l,{maxWidth:800,maxHeight:null}),o=t({},l,{width:400,height:null});function s(t){const e=t.includes("filters:format(webp)"),i=/[a-f0-9]+-\d+x\d+\.webp/.test(t);return e||i}function h(t,e,i){let{width:a,height:r,smartCrop:l,quality:n,format:o,fill:s}=e,[,h]=t.split("."),u="https://img2.storyblok.com";a&&r&&(u+=`/${a}x${r}`),l&&(u+="/smart");let p=[n&&`quality(${n})`,o&&o!==h&&`format(${o})`,s&&`fill(${s})`];return p=p.filter(t=>!0===Boolean(t)),p.length>0&&(u+=function(t){return t.reduce((t,e,i)=>`${t}:${e}`,"/filters")}(p)),u+=`/${t}`,console.log(u),u=u.replace("filters:quality(100)",`filters:quality(100):rotate(${i})`),console.log(u),u}function u(t,{width:e,height:i},a){return h(t,{width:(e/3).toFixed(0),height:(i/3).toFixed(0),quality:10},a)}function p(e,r={}){let l=i(e);if(!l)return null;let n=t({},o,r),{width:p,height:c}=n,{metadata:{dimensions:d},originalPath:f}=l,m=d.aspectRatio;n.height&&(m=p/n.height);let b=null;n.toFormat?b=n.toFormat:s(f)&&(b="jpg");let w=a.map(t=>Math.round(p*t)).filter(t=>t<d.width).reduce((e,i,r)=>{let l=`${a[r]}x`,o=Math.round(i/m),s=t({},n,{width:i,height:o}),u=h(f,t({},s,{format:"webp"})),p=h(f,t({},s,b&&{format:b}));return e.webp.push(`${u} ${l}`),e.base.push(`${p} ${l}`),e},{webp:[],base:[]}),g=Math.round(c||p/m),$=t({},n,{width:p,height:g}),x=h(f,t({},$,b&&{format:b})),y=h(f,t({},$,{format:"webp"}));return{base64:u(f,{width:p,height:c,aspectRatio:m}),aspectRatio:m,width:Math.round(p),height:g,src:x,srcWebp:y,srcSet:w.base.join(",\n")||null,srcSetWebp:w.webp.join(",\n")||null}}function c(e,a={},l=0){let o=i(e);if(!o)return null;let p=t({},n,a),{maxWidth:c}=p,{metadata:{dimensions:d},originalPath:f}=o,m=d.aspectRatio;p.maxHeight&&(m=c/p.maxHeight);let b=p.maxHeight||Math.round(c/d.aspectRatio),w=null;p.toFormat?w=p.toFormat:s(f)&&(w="jpg");let g=p.sizes||`(max-width: ${c}px) 100vw, ${c}px`,$=r.map(t=>Math.round(c*t)).filter(t=>t<d.width).concat(d.width).filter(t=>t<d.width).reduce((e,i)=>{let a={width:i,height:Math.round(i/m)},r=h(f,t({},p,a,{format:"webp"}),l),n=h(f,t({},p,a,{format:w}),l);return e.webp.push(`${r} ${i}w`),e.base.push(`${n} ${i}w`),e},{webp:[],base:[]}),x={width:c,height:b},y=h(f,t({},p,x,{format:w}),l),j=h(f,t({},p,x,{format:"webp"}),l);return{base64:u(f,{width:c,height:b,aspectRatio:m},l),aspectRatio:m,src:y,srcWebp:j,srcSet:$.base.join(",\n")||null,srcSetWebp:$.webp.join(",\n")||null,sizes:g}}export{p as getFixedGatsbyImage,c as getFluidGatsbyImage};
//# sourceMappingURL=index.modern.mjs.map
