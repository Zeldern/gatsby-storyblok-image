!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t||self).gatsbyStoryblokImage={})}(this,function(t){function e(){return e=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(t[a]=i[a])}return t},e.apply(this,arguments)}var i=/^(https?:)?\/\/a.storyblok.com\/f\/*[0-9]+\/*[0-9]*x*[0-9]*\/[A-Za-z0-9]+\/[\S]+\.[a-zA-Z]+/;function a(t){var e=null,a=null;if("string"==typeof t&&(e=t),"object"==typeof t&&(e=t.image,a=t.base64?t.base64:null),!(e=i.test(e)?e:null))return!1;var r=e.replace(/^(https?:)?\/\/a.storyblok.com\//,""),n=r.split("/"),o=n[4],l=n[2].split("x").map(function(t){return parseInt(t,10)}),u=l[0],s=l[1];return{originalPath:r,extension:o.split(".")[1],metadata:{dimensions:{width:u,height:s,aspectRatio:u/s},lqip:a}}}var r=[1,1.5,2,3],n=[.25,.5,1,1.5,2,3],o={quality:100,smartCrop:!0,format:null,fill:null,toFormat:null,base64:null,useBase64:!0},l=e({},o,{maxWidth:800,maxHeight:null}),u=e({},o,{width:400,height:null});function s(t){var e=t.includes("filters:format(webp)"),i=/[a-f0-9]+-\d+x\d+\.webp/.test(t);return e||i}function h(t,e,i){var a=e.width,r=e.height,n=e.smartCrop,o=e.quality,l=e.format,u=e.fill,s=t.split("."),h="https://img2.storyblok.com";a&&r&&(h+="/"+a+"x"+r),n&&(h+="/smart");var f=[o&&"quality("+o+")"].concat([l&&l!==s[1]&&"format("+l+")"],[u&&"fill("+u+")"]);return(f=f.filter(function(t){return!0===Boolean(t)})).length>0&&(h+=function(t){return t.reduce(function(t,e,i){return t+":"+e},"/filters")}(f)),h+="/"+t,console.log(h),h=h.replace("filters:quality(100)","filters:quality(100):rotate("+i+")"),console.log(h),h}function f(t,e,i){var a=e.height;return h(t,{width:(e.width/3).toFixed(0),height:(a/3).toFixed(0),quality:10},i)}t.getFixedGatsbyImage=function(t,i){void 0===i&&(i={});var n=a(t);if(!n)return null;var o=e({},u,i),l=o.width,p=o.height,c=n.metadata.dimensions,d=n.originalPath,m=c.aspectRatio;o.height&&(m=l/o.height);var b=null;o.toFormat?b=o.toFormat:s(d)&&(b="jpg");var g=r.map(function(t){return Math.round(l*t)}).filter(function(t){return t<c.width}).reduce(function(t,i,a){var n=r[a]+"x",l=Math.round(i/m),u=e({},o,{width:i,height:l}),s=h(d,e({},u,{format:"webp"})),f=h(d,e({},u,b&&{format:b}));return t.webp.push(s+" "+n),t.base.push(f+" "+n),t},{webp:[],base:[]}),w=Math.round(p||l/m),v=e({},o,{width:l,height:w}),y=h(d,e({},v,b&&{format:b})),x=h(d,e({},v,{format:"webp"}));return{base64:f(d,{width:l,height:p,aspectRatio:m}),aspectRatio:m,width:Math.round(l),height:w,src:y,srcWebp:x,srcSet:g.base.join(",\n")||null,srcSetWebp:g.webp.join(",\n")||null}},t.getFluidGatsbyImage=function(t,i,r){void 0===i&&(i={}),void 0===r&&(r=0);var o=a(t);if(!o)return null;var u=e({},l,i),p=u.maxWidth,c=o.metadata.dimensions,d=o.originalPath,m=c.aspectRatio;u.maxHeight&&(m=p/u.maxHeight);var b=u.maxHeight||Math.round(p/c.aspectRatio),g=null;u.toFormat?g=u.toFormat:s(d)&&(g="jpg");var w=u.sizes||"(max-width: "+p+"px) 100vw, "+p+"px",v=n.map(function(t){return Math.round(p*t)}).filter(function(t){return t<c.width}).concat(c.width).filter(function(t){return t<c.width}).reduce(function(t,i){var a={width:i,height:Math.round(i/m)},n=h(d,e({},u,a,{format:"webp"}),r),o=h(d,e({},u,a,{format:g}),r);return t.webp.push(n+" "+i+"w"),t.base.push(o+" "+i+"w"),t},{webp:[],base:[]}),y={width:p,height:b},x=h(d,e({},u,y,{format:g}),r),j=h(d,e({},u,y,{format:"webp"}),r);return{base64:f(d,{width:p,height:b,aspectRatio:m},r),aspectRatio:m,src:x,srcWebp:j,srcSet:v.base.join(",\n")||null,srcSetWebp:v.webp.join(",\n")||null,sizes:w}}});
//# sourceMappingURL=index.umd.js.map
